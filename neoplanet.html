<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒã‚ªãƒ—ãƒ©ãƒãƒƒãƒˆ è¨­å®šãƒ»ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬ã‚¢ãƒ—ãƒª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #000033;
            --accent-color: #0066ff;
            --gold-color: #ffd700;
            --space-blue: #001166;
            --planet-red: #ff3366;
            --text-light: #ffffff;
            --bg-dark: #000011;
            --bg-section: #000844;
            --border-color: #0099ff;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #000011;
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* å®‡å®™èƒŒæ™¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 102, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 51, 102, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--space-blue) 0%, var(--accent-color) 100%);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 102, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: "ğŸª";
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            left: -20px;
            top: -20px;
            animation: float 6s ease-in-out infinite;
        }

        header::after {
            content: "ğŸŒŸ";
            position: absolute;
            font-size: 80px;
            opacity: 0.1;
            right: -20px;
            bottom: -20px;
            animation: float 6s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
            position: relative;
            z-index: 1;
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
            to { text-shadow: 0 0 20px rgba(255, 255, 255, 0.8), 0 0 30px rgba(0, 102, 255, 0.6); }
        }

        .subtitle {
            font-size: 0.9em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .main-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-section, .result-section {
            background: rgba(0, 8, 68, 0.9);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 102, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: var(--gold-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #aaccff;
        }

        input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background: rgba(0, 33, 99, 0.8);
            color: var(--text-light);
            font-size: 1em;
            transition: all 0.3s ease;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 10px rgba(0, 102, 255, 0.5);
            background: rgba(0, 33, 99, 1);
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 5px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--accent-color) 0%, #0099ff 100%);
            color: var(--text-light);
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:hover::before {
            width: 300px;
            height: 300px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 102, 255, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result-box {
            background: rgba(0, 33, 99, 0.8);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--gold-color);
        }

        .result-title {
            font-size: 1.2em;
            color: var(--gold-color);
            margin-bottom: 10px;
        }

        .result-content {
            font-size: 0.95em;
            line-height: 1.6;
        }

        .setting-meter {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 10px;
            background: rgba(0, 33, 99, 0.8);
            border-radius: 8px;
        }

        .setting-item {
            text-align: center;
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .setting-item.highlight {
            background: linear-gradient(135deg, var(--accent-color) 0%, #0099ff 100%);
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 102, 255, 0.5);
        }

        .setting-value {
            font-size: 2em;
            font-weight: bold;
        }

        .setting-prob {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }

        .mode-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .mode-item {
            padding: 10px;
            text-align: center;
            background: rgba(0, 33, 99, 0.8);
            border-radius: 5px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .mode-item.likely {
            background: linear-gradient(135deg, var(--planet-red) 0%, #ff6699 100%);
            transform: scale(1.05);
            border-color: var(--gold-color);
        }

        .advice-section {
            background: linear-gradient(135deg, rgba(0, 33, 99, 0.8) 0%, rgba(0, 66, 166, 0.8) 100%);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 2px solid var(--gold-color);
        }

        .advice-title {
            font-size: 1.3em;
            color: var(--gold-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .advice-title::before {
            content: "ğŸš€";
            margin-right: 10px;
            font-size: 1.2em;
        }

        .advice-content {
            font-size: 1em;
            line-height: 1.8;
        }

        .indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .indicator.high {
            background: #4CAF50;
            animation: pulse 1s infinite;
        }

        .indicator.medium {
            background: #FFC107;
        }

        .indicator.low {
            background: #f44336;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 175, 80, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0); }
        }

        .collapsible {
            background: rgba(0, 33, 99, 0.8);
            color: var(--text-light);
            cursor: pointer;
            padding: 15px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.1em;
            margin-top: 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .collapsible:hover {
            background: rgba(0, 66, 166, 0.8);
        }

        .collapsible::after {
            content: '\002B';
            color: var(--gold-color);
            font-weight: bold;
            float: right;
        }

        .active::after {
            content: "\2212";
        }

        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            background: rgba(0, 17, 51, 0.5);
            border-radius: 0 0 5px 5px;
        }

        .collapsible-content.show {
            max-height: 1500px;
            padding: 15px;
        }

        .info-text {
            font-size: 0.85em;
            color: #aaccff;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="container">
        <header>
            <h1>ğŸª ãƒã‚ªãƒ—ãƒ©ãƒãƒƒãƒˆ è¨­å®šãƒ»ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬ã‚¢ãƒ—ãƒª ğŸŒŸ</h1>
            <div class="subtitle">å€‹äººä½¿ç”¨ç›®çš„ - å®Ÿæˆ¦ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è¨­å®šã¨ãƒ¢ãƒ¼ãƒ‰ã‚’åŒæ™‚æ¨æ¸¬</div>
        </header>

        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">ğŸ“Š åŸºæœ¬ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h2>
                
                <div class="input-group">
                    <label for="games">ç·ã‚²ãƒ¼ãƒ æ•°</label>
                    <input type="number" id="games" placeholder="ä¾‹: 1000" min="0">
                </div>

                <div class="input-group">
                    <label for="bb-count">BBå›æ•°ï¼ˆSBBå«ã‚€ï¼‰</label>
                    <input type="number" id="bb-count" placeholder="ä¾‹: 3" min="0">
                </div>

                <div class="input-group">
                    <label for="rb-count">RBå›æ•°</label>
                    <input type="number" id="rb-count" placeholder="ä¾‹: 1" min="0">
                </div>

                <div class="input-group">
                    <label for="bonus-total">ãƒœãƒ¼ãƒŠã‚¹åˆç®—å›æ•°</label>
                    <input type="number" id="bonus-total" placeholder="è‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™" readonly style="background: rgba(0, 33, 99, 0.5);">
                </div>

                <button class="collapsible">ğŸŒŸ æ˜Ÿåº§æ¼”å‡ºï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</button>
                <div class="collapsible-content">
                    <h4 style="color: var(--gold-color); margin-bottom: 15px;">ã‚µãƒ–æ¶²æ™¶ã‚¿ãƒƒãƒæ™‚ã®æ˜Ÿåº§ï¼ˆ101G/301Gï¼‰</h4>
                    <div class="input-group">
                        <label for="constellation-101">101Gæ™‚ã®æ˜Ÿåº§</label>
                        <select id="constellation-101">
                            <option value="none">ãªã—/ç¢ºèªã—ã¦ã„ãªã„</option>
                            <option value="uo">ã†ãŠåº§ï¼ˆåŸºæœ¬ï¼‰</option>
                            <option value="ohituji">ãŠã²ã¤ã˜åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†ï¼‰</option>
                            <option value="kani">ã‹ã«åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†ï¼‰</option>
                            <option value="oushi">ãŠã†ã—åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†å¼·ï¼‰</option>
                            <option value="koto">ã“ã¨åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="tenbin">ã¦ã‚“ã³ã‚“åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Cæ¿ƒåšï¼‰</option>
                            <option value="pegasus">ãƒšã‚¬ã‚µã‚¹åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰D/Eæ¿ƒåšï¼‰</option>
                            <option value="rino">ãƒªãƒåº§ï¼ˆè¨­å®š4ä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="kerot">ã‚±ãƒ­ãƒƒãƒˆï¼†ã‚±ãƒ­ãƒ«ãƒ³åº§ï¼ˆè¨­å®š6æ¿ƒåšï¼‰</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="constellation-301">301Gæ™‚ã®æ˜Ÿåº§</label>
                        <select id="constellation-301">
                            <option value="none">ãªã—/ç¢ºèªã—ã¦ã„ãªã„</option>
                            <option value="uo">ã†ãŠåº§ï¼ˆåŸºæœ¬ï¼‰</option>
                            <option value="ohituji">ãŠã²ã¤ã˜åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†ï¼‰</option>
                            <option value="kani">ã‹ã«åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†ï¼‰</option>
                            <option value="oushi">ãŠã†ã—åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bç¤ºå”†å¼·ï¼‰</option>
                            <option value="koto">ã“ã¨åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Bä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="tenbin">ã¦ã‚“ã³ã‚“åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰Cæ¿ƒåšï¼‰</option>
                            <option value="pegasus">ãƒšã‚¬ã‚µã‚¹åº§ï¼ˆãƒ¢ãƒ¼ãƒ‰D/Eæ¿ƒåšï¼‰</option>
                            <option value="rino">ãƒªãƒåº§ï¼ˆè¨­å®š4ä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="kerot">ã‚±ãƒ­ãƒƒãƒˆï¼†ã‚±ãƒ­ãƒ«ãƒ³åº§ï¼ˆè¨­å®š6æ¿ƒåšï¼‰</option>
                        </select>
                    </div>
                </div>

                <button class="collapsible">ğŸ® ç¤ºå”†æ¼”å‡ºï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</button>
                <div class="collapsible-content">
                    <h4 style="color: var(--gold-color); margin-bottom: 15px;">ãƒœãƒ¼ãƒŠã‚¹çµ‚äº†ç”»é¢</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="end-eisei">
                            <label for="end-eisei">è¡›æ˜Ÿï¼ˆå¶æ•°è¨­å®šç¤ºå”†ï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="end-uchu">
                            <label for="end-uchu">å®‡å®™é£›è¡Œå£«ï¼ˆè¨­å®š2ä»¥ä¸Šï¼‹é«˜è¨­å®šç¤ºå”†ï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="end-win">
                            <label for="end-win">ã‚¦ã‚£ãƒ³ã¡ã‚ƒã‚“ï¼ˆè¨­å®š6æ¿ƒåšï¼‰</label>
                        </div>
                    </div>

                    <h4 style="color: var(--gold-color); margin: 15px 0;">ã‚±ãƒ­ãƒƒãƒˆãƒˆãƒ­ãƒ•ã‚£ãƒ¼</h4>
                    <div class="input-group">
                        <select id="trophy">
                            <option value="none">ãªã—</option>
                            <option value="bronze">éŠ…ï¼ˆè¨­å®š2ä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="gold">é‡‘ï¼ˆè¨­å®š4ä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="kerot">ã‚±ãƒ­ãƒƒãƒˆæŸ„ï¼ˆè¨­å®š5ä»¥ä¸Šæ¿ƒåšï¼‰</option>
                            <option value="rainbow">è™¹ï¼ˆè¨­å®š6æ¿ƒåšï¼‰</option>
                        </select>
                    </div>

                    <h4 style="color: var(--gold-color); margin: 15px 0;">ç²å¾—æšæ•°è¡¨ç¤º</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="medal-456">
                            <label for="medal-456">456æšOVERï¼ˆè¨­å®š4ä»¥ä¸Šæ¿ƒåšï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="medal-666">
                            <label for="medal-666">666æšOVERï¼ˆè¨­å®š6æ¿ƒåšï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="medal-803">
                            <label for="medal-803">803æšOVERï¼ˆè¨­å®š6æ¿ƒåšï¼‰</label>
                        </div>
                    </div>
                </div>

                <button class="collapsible">ğŸš€ ãƒ©ãƒ³ãƒ—ãƒ»æ¼”å‡ºï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</button>
                <div class="collapsible-content">
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="kerot-lamp">
                            <label for="kerot-lamp">ã‚±ãƒ­ãƒƒãƒˆãƒ©ãƒ³ãƒ—ç‚¹ç¯ï¼ˆãƒ¢ãƒ¼ãƒ‰Eæ¿ƒåšï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="planet-lamp">
                            <label for="planet-lamp">ãƒ—ãƒ©ãƒãƒƒãƒˆãƒ©ãƒ³ãƒ—ç‚¹æ»…ï¼ˆãƒ•ãƒªãƒ¼ã‚ºå‰å…†/ãƒ¢ãƒ¼ãƒ‰Cï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="white-hole">
                            <label for="white-hole">ãƒ›ãƒ¯ã‚¤ãƒˆãƒ›ãƒ¼ãƒ«æ¼”å‡ºï¼ˆBBæ¿ƒåšï¼‹æ¬¡å›ãƒ¢ãƒ¼ãƒ‰Eæ¿ƒåšï¼‰</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="delay-30g">
                            <label for="delay-30g">30Gä»¥å†…ã«ç¬¬3åœæ­¢é…ã‚Œ2å›ï¼ˆé«˜ç¢ºæ¿ƒåšï¼‰</label>
                        </div>
                    </div>
                </div>

                <button class="collapsible">ğŸ“ ç¾åœ¨ã®çŠ¶æ³ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§é–‹ãï¼‰</button>
                <div class="collapsible-content">
                    <div class="input-group">
                        <label for="current-g">ãƒœãƒ¼ãƒŠã‚¹é–“ã‚²ãƒ¼ãƒ æ•°</label>
                        <input type="number" id="current-g" placeholder="ä¾‹: 250" min="0">
                    </div>

                    <div class="input-group">
                        <label for="early-bonus">100Gä»¥å†…ã®ãƒœãƒ¼ãƒŠã‚¹å›æ•°</label>
                        <input type="number" id="early-bonus" placeholder="ä¾‹: 2" min="0">
                    </div>

                    <div class="input-group">
                        <label for="is-reset">æœä¸€ãƒªã‚»ãƒƒãƒˆå°</label>
                        <select id="is-reset">
                            <option value="unknown">ä¸æ˜</option>
                            <option value="yes">ã¯ã„ï¼ˆãƒ¢ãƒ¼ãƒ‰Fï¼‰</option>
                            <option value="no">ã„ã„ãˆ</option>
                        </select>
                    </div>
                </div>

                <button onclick="analyze()" style="margin-top: 20px;">ğŸŒŸ è¨­å®šãƒ»ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬ã‚’å®Ÿè¡Œ</button>
                <button onclick="resetAll()" style="background: rgba(0, 66, 166, 0.8);">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
            </div>

            <div class="result-section">
                <h2 class="section-title">ğŸ“ˆ æ¨æ¸¬çµæœ</h2>
                <div id="results">
                    <div class="result-box">
                        <div class="result-content">ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ã€Œè¨­å®šãƒ»ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬ã‚’å®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ˜Ÿç©ºã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”Ÿæˆ
        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        createStars();

        // ãƒœãƒ¼ãƒŠã‚¹åˆç®—ã®è‡ªå‹•è¨ˆç®—
        document.getElementById('bb-count').addEventListener('input', updateBonusTotal);
        document.getElementById('rb-count').addEventListener('input', updateBonusTotal);

        function updateBonusTotal() {
            const bb = parseInt(document.getElementById('bb-count').value) || 0;
            const rb = parseInt(document.getElementById('rb-count').value) || 0;
            document.getElementById('bonus-total').value = bb + rb;
        }

        // è¨­å®šåˆ¥ãƒ‡ãƒ¼ã‚¿
        const settingData = {
            1: { bbRate: 1/280.4, rbRate: 1/596.7, bonusRate: 1/190.8, payout: 97.6 },
            2: { bbRate: 1/273.4, rbRate: 1/584.1, bonusRate: 1/186.2, payout: 99.0 },
            4: { bbRate: 1/247.3, rbRate: 1/553.6, bonusRate: 1/171.0, payout: 104.0 },
            5: { bbRate: 1/232.2, rbRate: 1/526.4, bonusRate: 1/161.1, payout: 108.5 },
            6: { bbRate: 1/210.5, rbRate: 1/504.2, bonusRate: 1/148.5, payout: 114.2 }
        };

        // æŠ˜ã‚ŠãŸãŸã¿æ©Ÿèƒ½
        const collapsibles = document.querySelectorAll('.collapsible');
        collapsibles.forEach(button => {
            button.addEventListener('click', function() {
                this.classList.toggle('active');
                const content = this.nextElementSibling;
                content.classList.toggle('show');
            });
        });

        function analyze() {
            const games = parseInt(document.getElementById('games').value) || 0;
            const bbCount = parseInt(document.getElementById('bb-count').value) || 0;
            const rbCount = parseInt(document.getElementById('rb-count').value) || 0;
            const bonusTotal = bbCount + rbCount;
            const currentG = parseInt(document.getElementById('current-g').value) || 0;
            const earlyBonus = parseInt(document.getElementById('early-bonus').value) || 0;
            const isReset = document.getElementById('is-reset').value;
            const const101 = document.getElementById('constellation-101').value;
            const const301 = document.getElementById('constellation-301').value;

            if (games === 0) {
                alert('ã‚²ãƒ¼ãƒ æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // è¨­å®šæ¨æ¸¬ã‚¹ã‚³ã‚¢è¨ˆç®—
            const scores = { 1: 100, 2: 100, 4: 100, 5: 100, 6: 100 };
            
            // ãƒœãƒ¼ãƒŠã‚¹ç¢ºç‡ã«ã‚ˆã‚‹è©•ä¾¡
            if (bonusTotal > 0) {
                const actualRate = games / bonusTotal;
                for (let setting of [1, 2, 4, 5, 6]) {
                    const expectedRate = 1 / settingData[setting].bonusRate;
                    const diff = Math.abs(actualRate - expectedRate);
                    scores[setting] -= diff * 0.15;
                }
            }

            // BB/RBæ¯”ç‡ã«ã‚ˆã‚‹è©•ä¾¡
            if (bbCount > 0 && rbCount > 0) {
                const actualBbRate = games / bbCount;
                const actualRbRate = games / rbCount;
                for (let setting of [1, 2, 4, 5, 6]) {
                    const expectedBbRate = 1 / settingData[setting].bbRate;
                    const expectedRbRate = 1 / settingData[setting].rbRate;
                    const bbDiff = Math.abs(actualBbRate - expectedBbRate);
                    const rbDiff = Math.abs(actualRbRate - expectedRbRate);
                    scores[setting] -= (bbDiff + rbDiff) * 0.08;
                }
            }

            // ç¤ºå”†æ¼”å‡ºã«ã‚ˆã‚‹è©•ä¾¡
            if (document.getElementById('end-eisei').checked) {
                scores[2] += 20; scores[4] += 20; scores[6] += 20;
            }
            if (document.getElementById('end-uchu').checked) {
                scores[1] -= 50; scores[4] += 15; scores[5] += 20; scores[6] += 25;
            }
            if (document.getElementById('end-win').checked) {
                scores[6] += 100;
            }

            // ãƒˆãƒ­ãƒ•ã‚£ãƒ¼
            const trophy = document.getElementById('trophy').value;
            if (trophy === 'bronze') { scores[1] -= 50; scores[2] += 20; }
            if (trophy === 'gold') { scores[1] -= 50; scores[2] -= 50; scores[4] += 30; }
            if (trophy === 'kerot') { scores[1] -= 50; scores[2] -= 50; scores[4] -= 30; scores[5] += 40; }
            if (trophy === 'rainbow') { scores[6] += 100; }

            // ç²å¾—æšæ•°è¡¨ç¤º
            if (document.getElementById('medal-456').checked) {
                scores[1] -= 50; scores[2] -= 50; scores[4] += 30;
            }
            if (document.getElementById('medal-666').checked || document.getElementById('medal-803').checked) {
                scores[6] += 80;
            }

            // æ˜Ÿåº§ã«ã‚ˆã‚‹è©•ä¾¡
            if (const101 === 'rino' || const301 === 'rino') {
                scores[1] -= 50; scores[2] -= 50; scores[4] += 40;
            }
            if (const101 === 'kerot' || const301 === 'kerot') {
                scores[6] += 100;
            }

            // ã‚¹ã‚³ã‚¢ã‚’æ­£è¦åŒ–ï¼ˆç¢ºç‡ã«å¤‰æ›ï¼‰
            const maxScore = Math.max(...Object.values(scores));
            const minScore = Math.min(...Object.values(scores));
            const range = maxScore - minScore || 1;

            const probabilities = {};
            let totalProb = 0;
            for (let setting of [1, 2, 4, 5, 6]) {
                probabilities[setting] = Math.exp((scores[setting] - minScore) / range * 2);
                totalProb += probabilities[setting];
            }

            // ç¢ºç‡ã‚’æ­£è¦åŒ–
            for (let setting of [1, 2, 4, 5, 6]) {
                probabilities[setting] = (probabilities[setting] / totalProb * 100).toFixed(1);
            }

            // æœ€ã‚‚å¯èƒ½æ€§ã®é«˜ã„è¨­å®šã‚’ç‰¹å®š
            const mostLikely = Object.entries(probabilities).reduce((a, b) => 
                parseFloat(a[1]) > parseFloat(b[1]) ? a : b
            )[0];

            // ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬
            let modeAnalysis = analyzeModes(const101, const301, earlyBonus, bonusTotal, 
                document.getElementById('kerot-lamp').checked,
                document.getElementById('planet-lamp').checked,
                document.getElementById('white-hole').checked,
                isReset);

            // ã‚„ã‚ã©ãåˆ¤å®š
            let quitAdvice = generateQuitAdvice(currentG, modeAnalysis, isReset);

            // çµæœè¡¨ç¤º
            displayResults(probabilities, mostLikely, games, bonusTotal, modeAnalysis, quitAdvice);
        }

        function analyzeModes(const101, const301, earlyBonus, bonusTotal, kerotLamp, planetLamp, whiteHole, isReset) {
            let modes = {
                A: 30,
                B: 20,
                C: 20,
                D: 15,
                E: 10,
                F: isReset === 'yes' ? 50 : 5
            };

            // æ˜Ÿåº§ã«ã‚ˆã‚‹ãƒ¢ãƒ¼ãƒ‰è©•ä¾¡
            if (const101 === 'tenbin' || const301 === 'tenbin') {
                modes.C += 50; modes.A -= 20; modes.B -= 20;
            }
            if (const101 === 'pegasus' || const301 === 'pegasus') {
                modes.D += 40; modes.E += 40; modes.A -= 30; modes.B -= 20; modes.C -= 30;
            }
            if (const101 === 'ohituji' || const301 === 'ohituji' || 
                const101 === 'kani' || const301 === 'kani') {
                modes.B += 30; modes.A -= 10;
            }
            if (const101 === 'oushi' || const301 === 'oushi') {
                modes.B += 40; modes.A -= 15;
            }
            if (const101 === 'koto' || const301 === 'koto') {
                modes.B += 30; modes.C += 20; modes.D += 15; modes.E += 10; modes.A -= 40;
            }

            // ãƒ©ãƒ³ãƒ—ã«ã‚ˆã‚‹è©•ä¾¡
            if (kerotLamp) {
                modes.E += 60; modes.D -= 10; modes.A -= 30; modes.B -= 20; modes.C -= 20;
            }
            if (planetLamp) {
                modes.C += 30; modes.A -= 10;
            }
            if (whiteHole) {
                modes.E += 50; modes.D += 30;
            }

            // æ—©ã„å½“ãŸã‚Šã«ã‚ˆã‚‹è©•ä¾¡
            if (earlyBonus > 0 && bonusTotal > 0) {
                const earlyRate = earlyBonus / bonusTotal;
                if (earlyRate > 0.5) {
                    modes.D += 30; modes.E += 40;
                } else if (earlyRate > 0.3) {
                    modes.D += 20; modes.E += 20;
                }
            }

            // æœ€ã‚‚å¯èƒ½æ€§ã®é«˜ã„ãƒ¢ãƒ¼ãƒ‰ã‚’ç‰¹å®š
            const totalMode = Object.values(modes).reduce((a, b) => a + b, 0);
            for (let mode in modes) {
                modes[mode] = Math.max(0, modes[mode]);
                modes[mode] = ((modes[mode] / totalMode) * 100).toFixed(1);
            }

            return modes;
        }

        function generateQuitAdvice(currentG, modeAnalysis, isReset) {
            let advice = [];
            let shouldContinue = false;

            // ç¾åœ¨ã®ã‚²ãƒ¼ãƒ æ•°ã«ã‚ˆã‚‹åˆ¤å®š
            if (currentG <= 100) {
                advice.push("ğŸŒŸ 100Gä»¥å†…ï¼šç´„50%ã§ãƒœãƒ¼ãƒŠã‚¹å½“é¸ã®å¯èƒ½æ€§");
                advice.push("ğŸ“ 101Gã§ã‚µãƒ–æ¶²æ™¶ã‚¿ãƒƒãƒã§æ˜Ÿåº§ç¢ºèªæ¨å¥¨");
                shouldContinue = true;
            } else if (currentG >= 600) {
                advice.push("âš ï¸ 600Gä»¥ä¸Šï¼šå¤©äº•ï¼ˆ777Gï¼‰ã¾ã§ç¶šè¡Œæ¨å¥¨");
                shouldContinue = true;
            }

            // ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹åˆ¤å®š
            const modeD = parseFloat(modeAnalysis.D);
            const modeE = parseFloat(modeAnalysis.E);
            const modeC = parseFloat(modeAnalysis.C);
            
            if (modeD >= 30 || modeE >= 30) {
                advice.push("ğŸš€ ãƒ¢ãƒ¼ãƒ‰D/Eæ»åœ¨ã®å¯èƒ½æ€§å¤§ï¼šé€£ãƒãƒ£ãƒ³ãƒ¢ãƒ¼ãƒ‰æœŸå¾…");
                shouldContinue = true;
            } else if (modeC >= 40) {
                advice.push("ğŸ’« ãƒ¢ãƒ¼ãƒ‰Cæ¿ƒåšï¼šãƒ¢ãƒ¼ãƒ‰Eã¸ã®ç§»è¡Œã«æœŸå¾…ï¼ˆç´„50%ï¼‰");
            }

            // ãƒªã‚»ãƒƒãƒˆåˆ¤å®š
            if (isReset === 'yes') {
                advice.push("ğŸ”„ ãƒªã‚»ãƒƒãƒˆå°ï¼šãƒœãƒ¼ãƒŠã‚¹å¾Œãƒ¢ãƒ¼ãƒ‰Bä»¥ä¸Šç¢ºå®š");
                if (currentG <= 500) {
                    advice.push("ğŸ“Š å¤©äº•500Gã«çŸ­ç¸®");
                }
            }

            // ç·åˆåˆ¤å®š
            if (shouldContinue) {
                advice.unshift("âœ… ç¶šè¡Œæ¨å¥¨");
            } else if (currentG <= 101) {
                advice.unshift("â¸ï¸ 101Gã®æ˜Ÿåº§ç¢ºèªå¾Œã«åˆ¤æ–­");
            } else {
                advice.unshift("â¹ï¸ ã‚„ã‚ã©ãå€™è£œ");
            }

            return advice;
        }

        function displayResults(probabilities, mostLikely, games, bonusTotal, modeAnalysis, quitAdvice) {
            const resultsDiv = document.getElementById('results');
            
            // è¨­å®š3ã¯å­˜åœ¨ã—ãªã„ãŸã‚é™¤å¤–
            const settings = [1, 2, 4, 5, 6];
            
            let html = `
                <div class="setting-meter">
                    ${settings.map(s => `
                        <div class="setting-item ${s == mostLikely ? 'highlight' : ''}">
                            <div class="setting-value">è¨­å®š${s}</div>
                            <div class="setting-prob">${probabilities[s] || '0'}%</div>
                        </div>
                    `).join('')}
                </div>

                <div class="result-box">
                    <div class="result-title">ğŸ“Š å®Ÿæˆ¦ãƒ‡ãƒ¼ã‚¿åˆ†æ</div>
                    <div class="result-content">
                        ãƒœãƒ¼ãƒŠã‚¹åˆç®—: ${bonusTotal > 0 ? `1/${(games/bonusTotal).toFixed(1)}` : '---'}<br>
                        ç·ã‚²ãƒ¼ãƒ æ•°: ${games}G
                    </div>
                </div>

                <div class="result-box">
                    <div class="result-title">ğŸŒŸ è¨­å®šæ¨æ¸¬çµæœ</div>
                    <div class="result-content">
                        <strong style="font-size: 1.2em; color: var(--gold-color);">
                            æœ€æœ‰åŠ›å€™è£œ: è¨­å®š${mostLikely} (${probabilities[mostLikely]}%)
                        </strong><br>
                        <span class="indicator ${probabilities[mostLikely] >= 30 ? 'high' : probabilities[mostLikely] >= 20 ? 'medium' : 'low'}"></span>
                        ä¿¡é ¼åº¦: ${probabilities[mostLikely] >= 30 ? 'é«˜' : probabilities[mostLikely] >= 20 ? 'ä¸­' : 'ä½'}
                    </div>
                </div>

                <div class="result-box">
                    <div class="result-title">ğŸš€ ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬çµæœ</div>
                    <div class="mode-display">
                        ${Object.entries(modeAnalysis).map(([mode, prob]) => `
                            <div class="mode-item ${parseFloat(prob) >= 25 ? 'likely' : ''}">
                                <div style="font-weight: bold;">ãƒ¢ãƒ¼ãƒ‰${mode}</div>
                                <div>${prob}%</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="advice-section">
                    <div class="advice-title">ã‚„ã‚ã©ãåˆ¤æ–­</div>
                    <div class="advice-content">
                        ${quitAdvice.map((advice, i) => 
                            `${i === 0 ? `<strong style="font-size: 1.2em;">${advice}</strong>` : advice}<br>`
                        ).join('')}
                    </div>
                </div>
            `;

            resultsDiv.innerHTML = html;
        }

        function resetAll() {
            if (confirm('ã™ã¹ã¦ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                document.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
                document.getElementById('results').innerHTML = `
                    <div class="result-box">
                        <div class="result-content">ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ã€Œè¨­å®šãƒ»ãƒ¢ãƒ¼ãƒ‰æ¨æ¸¬ã‚’å®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>

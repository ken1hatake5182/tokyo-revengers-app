<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ãƒã‚¹ãƒ­ ãƒãƒŠãƒ“ è¨­å®šæ¨æ¸¬ãƒ„ãƒ¼ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #1a0a0a 0%, #2d1414 50%, #1a0505 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 100, 100, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 100, 100, 0.3);
        }

        .header h1 {
            font-size: 28px;
            color: #ff6b6b;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .header p {
            font-size: 14px;
            color: #ffcccb;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 20px;
            color: #ffd700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-row {
            display: grid;
            grid-template-columns: 200px 150px 150px;
            gap: 15px;
            margin-bottom: 15px;
            align-items: center;
        }

        .input-label {
            color: #ffcccb;
            font-size: 14px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .input-group label {
            font-size: 12px;
            color: #999;
        }

        .input-group input {
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 16px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .result-display {
            text-align: center;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            font-weight: bold;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #666 0%, #888 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(136, 136, 136, 0.4);
        }

        .results {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .result-item {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid;
            background: rgba(0, 0, 0, 0.3);
        }

        .setting-1 { border-color: #808080; }
        .setting-2 { border-color: #00ff00; }
        .setting-5 { border-color: #ffa500; }
        .setting-6 { border-color: #ff0000; }

        .probability {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }

        .confidence-bar {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 10px;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b 0%, #ffd700 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        .detail-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
            font-size: 14px;
        }

        .detail-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            border-radius: 5px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .special-flags {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .flag-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .flag-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .flag-item label {
            color: #ffd700;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .detail-info {
                grid-template-columns: 1fr;
            }
        }

        .info-badge {
            display: inline-block;
            padding: 3px 8px;
            background: rgba(255, 215, 0, 0.2);
            border-radius: 5px;
            font-size: 12px;
            color: #ffd700;
            margin-left: 10px;
        }

        .judge-box {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .judge-title {
            font-size: 18px;
            color: #ffd700;
            margin-bottom: 10px;
        }

        .judge-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .judge-good {
            background: rgba(0, 255, 0, 0.2);
            border-left: 3px solid #00ff00;
        }

        .judge-bad {
            background: rgba(255, 0, 0, 0.2);
            border-left: 3px solid #ff0000;
        }

        .judge-normal {
            background: rgba(255, 255, 255, 0.1);
            border-left: 3px solid #888;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† ã‚¹ãƒã‚¹ãƒ­ ãƒãƒŠãƒ“ è¨­å®šæ¨æ¸¬ãƒ„ãƒ¼ãƒ«</h1>
            <p>å°å½¹ç¢ºç‡ãƒ»ãƒœãƒ¼ãƒŠã‚¹ç¢ºç‡ã‚’å…¥åŠ›ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¨­å®šã‚’æ¨æ¸¬ï¼</p>
        </div>

        <!-- åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ -->
        <div class="section">
            <div class="section-title">ğŸ° åŸºæœ¬ãƒ‡ãƒ¼ã‚¿</div>
            <div class="input-row">
                <div class="input-label">ç·å›è»¢æ•°</div>
                <div class="input-group">
                    <input type="number" id="totalGames" placeholder="ä¾‹: 3000">
                </div>
                <div class="result-display" id="totalGamesDisplay">-</div>
            </div>
        </div>

        <!-- ãƒœãƒ¼ãƒŠã‚¹ç¢ºç‡ -->
        <div class="section">
            <div class="section-title">ğŸŠ ãƒœãƒ¼ãƒŠã‚¹ç¢ºç‡</div>
            <div class="input-row">
                <div class="input-label">BBå›æ•°</div>
                <div class="input-group">
                    <input type="number" id="bbCount" placeholder="ä¾‹: 10">
                </div>
                <div class="result-display" id="bbProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">RBå›æ•°</div>
                <div class="input-group">
                    <input type="number" id="rbCount" placeholder="ä¾‹: 8">
                </div>
                <div class="result-display" id="rbProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">ãƒœãƒ¼ãƒŠã‚¹åˆç®—</div>
                <div class="input-group"></div>
                <div class="result-display" id="bonusProb">-</div>
            </div>
        </div>

        <!-- é€šå¸¸æ™‚å°å½¹ -->
        <div class="section">
            <div class="section-title">ğŸŒ¸ é€šå¸¸æ™‚å°å½¹ã‚«ã‚¦ãƒ³ãƒˆ</div>
            <div class="input-row">
                <div class="input-label">é¢¨éˆ´A <span class="info-badge">é‡è¦</span></div>
                <div class="input-group">
                    <input type="number" id="furinA" placeholder="ä¾‹: 230">
                </div>
                <div class="result-display" id="furinAProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">é¢¨éˆ´B</div>
                <div class="input-group">
                    <input type="number" id="furinB" placeholder="ä¾‹: 80">
                </div>
                <div class="result-display" id="furinBProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">é¢¨éˆ´åˆç®— <span class="info-badge">é‡è¦</span></div>
                <div class="input-group"></div>
                <div class="result-display" id="furinTotalProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">æ°·A</div>
                <div class="input-group">
                    <input type="number" id="kooriA" placeholder="ä¾‹: 65">
                </div>
                <div class="result-display" id="kooriAProb">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">ãƒã‚§ãƒªãƒ¼A1</div>
                <div class="input-group">
                    <input type="number" id="cherryA1" placeholder="ä¾‹: 30">
                </div>
                <div class="result-display" id="cherryA1Prob">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">ãƒã‚§ãƒªãƒ¼A2</div>
                <div class="input-group">
                    <input type="number" id="cherryA2" placeholder="ä¾‹: 150">
                </div>
                <div class="result-display" id="cherryA2Prob">-</div>
            </div>
            <div class="input-row">
                <div class="input-label">ãƒã‚§ãƒªãƒ¼B</div>
                <div class="input-group">
                    <input type="number" id="cherryB" placeholder="ä¾‹: 10">
                </div>
                <div class="result-display" id="cherryBProb">-</div>
            </div>
        </div>

        <!-- BBä¸­ãƒ‡ãƒ¼ã‚¿ -->
        <div class="section">
            <div class="section-title">ğŸ’ BBä¸­ãƒ‡ãƒ¼ã‚¿</div>
            <div class="input-row">
                <div class="input-label">BBä¸­ æ–œã‚é¢¨éˆ´å‡ºç¾å›æ•°</div>
                <div class="input-group">
                    <input type="number" id="bbNanameFurin" placeholder="ä¾‹: 5">
                </div>
                <div class="result-display" id="bbNanameFurinDisplay">-</div>
            </div>
            <div class="special-flags">
                <div class="flag-item">
                    <input type="checkbox" id="bbBarake">
                    <label for="bbBarake">BBä¸­ãƒãƒ©ã‚±ç›®å‡ºç¾ï¼ˆè¨­å®š5ä»¥ä¸Šæ¿ƒåšï¼ï¼‰</label>
                </div>
            </div>
        </div>

        <!-- RBä¸­ãƒ‡ãƒ¼ã‚¿ -->
        <div class="section">
            <div class="section-title">ğŸ´ RBä¸­ãƒ‡ãƒ¼ã‚¿</div>
            <div class="input-row">
                <div class="input-label">RBä¸­ 1æšå½¹å‡ºç¾å›æ•°</div>
                <div class="input-group">
                    <input type="number" id="rb1mai" placeholder="ä¾‹: 15">
                </div>
                <div class="result-display" id="rb1maiDisplay">-</div>
            </div>
            <div class="special-flags">
                <div class="flag-item">
                    <input type="checkbox" id="rbBarake">
                    <label for="rbBarake">RBä¸­ãƒãƒ©ã‚±ç›®å‡ºç¾ï¼ˆè¨­å®š6æ¿ƒåšï¼ï¼‰</label>
                </div>
                <div class="flag-item">
                    <input type="checkbox" id="rbPeace">
                    <label for="rbPeace">RBçµ‚äº†ç”»é¢ãƒ”ãƒ¼ã‚¹ãƒãƒ¼ã‚¯ï¼ˆè¨­å®š2ä»¥ä¸Šæ¿ƒåšï¼ï¼‰</label>
                </div>
            </div>
        </div>

        <!-- ãƒœã‚¿ãƒ³ -->
        <div class="button-group">
            <button class="btn btn-primary" onclick="calculate()">ğŸ“Š è¨­å®šæ¨æ¸¬</button>
            <button class="btn btn-secondary" onclick="resetAll()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
        </div>

        <!-- çµæœè¡¨ç¤º -->
        <div id="results" style="display: none;">
            <div class="section">
                <div class="section-title">ğŸ“ˆ æ¨æ¸¬çµæœ</div>
                <div class="results">
                    <div id="settingResults"></div>
                    <div class="judge-box" id="judgeBox"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const settingData = {
            1: {
                bb: 297.9, rb: 394.8, bonus: 169.8,
                furinA: 12.9, furinB: 38.4, furinTotal: 9.68,
                kooriA: 46.3,
                cherryA1: 99.4, cherryA2: 21.0, cherryB: 307.7,
                bbNanameFurin: 10.0, rb1mai: 8.0
            },
            2: {
                bb: 292.6, rb: 358.1, bonus: 161.0,
                furinA: 12.5, furinB: 38.7, furinTotal: 9.45,
                kooriA: 47.3,
                cherryA1: 99.4, cherryA2: 19.4, cherryB: 306.2,
                bbNanameFurin: 7.0, rb1mai: 8.0
            },
            5: {
                bb: 284.9, rb: 313.6, bonus: 149.3,
                furinA: 12.1, furinB: 36.2, furinTotal: 9.06,
                kooriA: 46.2,
                cherryA1: 99.4, cherryA2: 20.5, cherryB: 300.6,
                bbNanameFurin: 10.0, rb1mai: 7.0
            },
            6: {
                bb: 273.1, rb: 282.5, bonus: 138.8,
                furinA: 11.5, furinB: 34.5, furinTotal: 8.64,
                kooriA: 47.4,
                cherryA1: 99.3, cherryA2: 19.6, cherryB: 297.9,
                bbNanameFurin: 7.0, rb1mai: 7.0
            }
        };

        function calculate() {
            const totalGames = parseInt(document.getElementById('totalGames').value) || 0;
            
            if (totalGames === 0) {
                alert('ç·å›è»¢æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // ãƒœãƒ¼ãƒŠã‚¹ç¢ºç‡è¨ˆç®—
            const bbCount = parseInt(document.getElementById('bbCount').value) || 0;
            const rbCount = parseInt(document.getElementById('rbCount').value) || 0;
            const bonusTotal = bbCount + rbCount;

            const bbProb = bbCount > 0 ? totalGames / bbCount : 0;
            const rbProb = rbCount > 0 ? totalGames / rbCount : 0;
            const bonusProb = bonusTotal > 0 ? totalGames / bonusTotal : 0;

            document.getElementById('bbProb').textContent = bbCount > 0 ? `1/${bbProb.toFixed(1)}` : '-';
            document.getElementById('rbProb').textContent = rbCount > 0 ? `1/${rbProb.toFixed(1)}` : '-';
            document.getElementById('bonusProb').textContent = bonusTotal > 0 ? `1/${bonusProb.toFixed(1)}` : '-';

            // å°å½¹ç¢ºç‡è¨ˆç®—
            const furinA = parseInt(document.getElementById('furinA').value) || 0;
            const furinB = parseInt(document.getElementById('furinB').value) || 0;
            const kooriA = parseInt(document.getElementById('kooriA').value) || 0;
            const cherryA1 = parseInt(document.getElementById('cherryA1').value) || 0;
            const cherryA2 = parseInt(document.getElementById('cherryA2').value) || 0;
            const cherryB = parseInt(document.getElementById('cherryB').value) || 0;

            const furinAProb = furinA > 0 ? totalGames / furinA : 0;
            const furinBProb = furinB > 0 ? totalGames / furinB : 0;
            const furinTotal = furinA + furinB;
            const furinTotalProb = furinTotal > 0 ? totalGames / furinTotal : 0;
            const kooriAProb = kooriA > 0 ? totalGames / kooriA : 0;
            const cherryA1Prob = cherryA1 > 0 ? totalGames / cherryA1 : 0;
            const cherryA2Prob = cherryA2 > 0 ? totalGames / cherryA2 : 0;
            const cherryBProb = cherryB > 0 ? totalGames / cherryB : 0;

            document.getElementById('furinAProb').textContent = furinA > 0 ? `1/${furinAProb.toFixed(1)}` : '-';
            document.getElementById('furinBProb').textContent = furinB > 0 ? `1/${furinBProb.toFixed(1)}` : '-';
            document.getElementById('furinTotalProb').textContent = furinTotal > 0 ? `1/${furinTotalProb.toFixed(1)}` : '-';
            document.getElementById('kooriAProb').textContent = kooriA > 0 ? `1/${kooriAProb.toFixed(1)}` : '-';
            document.getElementById('cherryA1Prob').textContent = cherryA1 > 0 ? `1/${cherryA1Prob.toFixed(1)}` : '-';
            document.getElementById('cherryA2Prob').textContent = cherryA2 > 0 ? `1/${cherryA2Prob.toFixed(1)}` : '-';
            document.getElementById('cherryBProb').textContent = cherryB > 0 ? `1/${cherryBProb.toFixed(1)}` : '-';

            // BBä¸­ãƒ»RBä¸­ãƒ‡ãƒ¼ã‚¿
            const bbNanameFurin = parseInt(document.getElementById('bbNanameFurin').value) || 0;
            const rb1mai = parseInt(document.getElementById('rb1mai').value) || 0;
            document.getElementById('bbNanameFurinDisplay').textContent = bbNanameFurin > 0 ? `${bbNanameFurin}å›` : '-';
            document.getElementById('rb1maiDisplay').textContent = rb1mai > 0 ? `${rb1mai}å›` : '-';

            // =============================================
            // ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
            // å„è¨­å®šã¨ã®ã€Œè¿‘ã•ã€ã‚’ã‚¹ã‚³ã‚¢åŒ–ã™ã‚‹ã€‚
            // å·®ãŒå°ã•ã„ã»ã©é«˜ã‚¹ã‚³ã‚¢ã€‚å·®ãŒå¤§ãã™ããŸã‚‰ã‚¹ã‚³ã‚¢0ã«ã¯ã›ãš
            // æœ€ä½å€¤ã‚’è¨­ã‘ã‚‹ã“ã¨ã§ã€Œå®Œå…¨ã«æ¶ˆãˆãªã„ã€ã‚ˆã†ã«ã™ã‚‹ã€‚
            // =============================================
            let scores = { 1: 10, 2: 10, 5: 10, 6: 10 }; // å…¨è¨­å®šã«æœ€ä½ã‚¹ã‚³ã‚¢10ã‚’ä¿è¨¼
            let judgements = [];

            // ---- ãƒœãƒ¼ãƒŠã‚¹åˆç®—è©•ä¾¡ï¼ˆé‡ã¿: ä¸­ï¼‰ ----
            if (bonusTotal > 0) {
                for (let s in settingData) {
                    const diff = Math.abs(bonusProb - settingData[s].bonus);
                    // å·®ãŒå°ã•ã„ã»ã©é«˜ã‚¹ã‚³ã‚¢ã€‚å·®30ã§Â±0ã«ãªã‚‹ãŒæœ€ä½0.5ã¯åŠ ç®—
                    scores[s] += Math.max(0.5, 15 - diff * 0.5);
                }
                let judge = 'normal', text = 'æ¨™æº–çš„';
                if (bonusProb < 150) { judge = 'good'; text = 'é«˜è¨­å®šã®æœŸå¾…å¤§ï¼'; }
                else if (bonusProb > 165) { judge = 'bad'; text = 'ä½è¨­å®šã®å¯èƒ½æ€§'; }
                judgements.push({ label: 'ãƒœãƒ¼ãƒŠã‚¹åˆç®—', value: `1/${bonusProb.toFixed(1)}`, judge, text });
            }

            // ---- BBç¢ºç‡è©•ä¾¡ï¼ˆé‡ã¿: å°ï¼‰ ----
            if (bbCount > 0) {
                for (let s in settingData) {
                    const diff = Math.abs(bbProb - settingData[s].bb);
                    scores[s] += Math.max(0.5, 10 - diff * 0.3);
                }
            }

            // ---- RBç¢ºç‡è©•ä¾¡ï¼ˆé‡ã¿: å°ï¼‰ ----
            if (rbCount > 0) {
                for (let s in settingData) {
                    const diff = Math.abs(rbProb - settingData[s].rb);
                    scores[s] += Math.max(0.5, 10 - diff * 0.3);
                }
            }

            // ---- é¢¨éˆ´åˆç®—è©•ä¾¡ï¼ˆé‡ã¿: å¤§ãƒ»æœ€é‡è¦ï¼‰ ----
            if (furinTotal > 0) {
                for (let s in settingData) {
                    const diff = Math.abs(furinTotalProb - settingData[s].furinTotal);
                    scores[s] += Math.max(0.5, 20 - diff * 4);
                }
                let judge = 'normal', text = 'æ¨™æº–çš„';
                if (furinTotalProb < 9.0) { judge = 'good'; text = 'é«˜è¨­å®šç¤ºå”†ï¼'; }
                else if (furinTotalProb > 9.5) { judge = 'bad'; text = 'ä½è¨­å®šã®å¯èƒ½æ€§'; }
                judgements.push({ label: 'é¢¨éˆ´åˆç®—', value: `1/${furinTotalProb.toFixed(2)}`, judge, text });
            }

            // ---- é¢¨éˆ´Aè©•ä¾¡ï¼ˆé‡ã¿: ä¸­ï¼‰ ----
            if (furinA > 0) {
                for (let s in settingData) {
                    const diff = Math.abs(furinAProb - settingData[s].furinA);
                    scores[s] += Math.max(0.5, 15 - diff * 3);
                }
                let judge = 'normal', text = 'æ¨™æº–çš„';
                if (furinAProb < 12.0) { judge = 'good'; text = 'é«˜è¨­å®šã®æœŸå¾…ï¼'; }
                else if (furinAProb > 12.7) { judge = 'bad'; text = 'ä½è¨­å®šã®å¯èƒ½æ€§'; }
                judgements.push({ label: 'é¢¨éˆ´A', value: `1/${furinAProb.toFixed(1)}`, judge, text });
            }

            // ---- BBä¸­æ–œã‚é¢¨éˆ´è©•ä¾¡ï¼ˆå¶æ•°ç¤ºå”†ï¼‰ ----
            if (bbNanameFurin > 0 && bbCount > 0) {
                const nanameAvg = bbNanameFurin / bbCount;
                if (nanameAvg > 1.3) {
                    scores[2] += 8;
                    scores[6] += 8;
                    judgements.push({ label: 'BBä¸­æ–œã‚é¢¨éˆ´', value: `å¹³å‡${nanameAvg.toFixed(1)}å›/BB`, judge: 'good', text: 'å¶æ•°è¨­å®šç¤ºå”†' });
                }
            }

            // ---- ç‰¹æ®Šãƒ•ãƒ©ã‚°è©•ä¾¡ï¼ˆç¢ºå®šæ¼”å‡ºï¼šä¹—æ•°æ–¹å¼ã§ä»–è¨­å®šã‚’ç›¸å¯¾çš„ã«ä¸‹ã’ã‚‹ï¼‰ ----
            const bbBarake = document.getElementById('bbBarake').checked;
            const rbBarake = document.getElementById('rbBarake').checked;
            const rbPeace  = document.getElementById('rbPeace').checked;

            if (bbBarake) {
                // è¨­å®š5ä»¥ä¸Šæ¿ƒåš â†’ è¨­å®š1ãƒ»2ã‚’å¤§å¹…ãƒ€ã‚¦ãƒ³
                scores[1] *= 0.05;
                scores[2] *= 0.05;
                scores[5] += 20;
                scores[6] += 20;
                judgements.push({ label: 'BBä¸­ãƒãƒ©ã‚±ç›®', value: 'å‡ºç¾', judge: 'good', text: 'è¨­å®š5ä»¥ä¸Šæ¿ƒåšï¼' });
            }

            if (rbBarake) {
                // è¨­å®š6æ¿ƒåš â†’ ä»–è¨­å®šã‚’å¤§å¹…ãƒ€ã‚¦ãƒ³
                scores[1] *= 0.02;
                scores[2] *= 0.02;
                scores[5] *= 0.02;
                scores[6] += 40;
                judgements.push({ label: 'RBä¸­ãƒãƒ©ã‚±ç›®', value: 'å‡ºç¾', judge: 'good', text: 'è¨­å®š6æ¿ƒåšï¼' });
            }

            if (rbPeace) {
                // è¨­å®š2ä»¥ä¸Šæ¿ƒåš â†’ è¨­å®š1ã‚’ãƒ€ã‚¦ãƒ³
                scores[1] *= 0.1;
                scores[2] += 10;
                scores[5] += 10;
                scores[6] += 10;
                judgements.push({ label: 'RBçµ‚äº†ç”»é¢', value: 'ãƒ”ãƒ¼ã‚¹ãƒãƒ¼ã‚¯', judge: 'good', text: 'è¨­å®š2ä»¥ä¸Šæ¿ƒåšï¼' });
            }

            // ---- RBä¸­1æšå½¹è©•ä¾¡ï¼ˆé‡ã¿: å°ï¼‰ ----
            if (rb1mai > 0 && rbCount > 0) {
                const maiAvg = rb1mai / rbCount;
                for (let s in settingData) {
                    const expected = 12 / settingData[s].rb1mai;
                    const diff = Math.abs(maiAvg - expected);
                    scores[s] += Math.max(0.5, 8 - diff * 5);
                }
                if (maiAvg > 1.6) {
                    judgements.push({ label: 'RBä¸­1æšå½¹', value: `å¹³å‡${maiAvg.toFixed(1)}å›/RB`, judge: 'good', text: 'è¨­å®š5ä»¥ä¸Šç¤ºå”†' });
                }
            }

            // =============================================
            // åˆè¨ˆ100%ã«ãªã‚‹ã‚ˆã†æ­£è¦åŒ–ï¼ˆã‚½ãƒ•ãƒˆãƒãƒƒã‚¯ã‚¹çš„ãªå¤‰æ›ï¼‰
            // =============================================
            const totalScore = Object.values(scores).reduce((a, b) => a + b, 0);
            let percentages = {};
            for (let s in scores) {
                percentages[s] = (scores[s] / totalScore * 100);
            }

            // çµæœè¡¨ç¤ºï¼ˆè¨­å®š6ã‹ã‚‰é †ã«è¡¨ç¤ºï¼‰
            let resultsHTML = '';
            const settings = [6, 5, 2, 1];
            settings.forEach(setting => {
                const pct = percentages[setting].toFixed(1);
                resultsHTML += `
                    <div class="result-item setting-${setting}">
                        <h3>è¨­å®š${setting}</h3>
                        <div class="probability">${pct}%</div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: ${pct}%">${pct}%</div>
                        </div>
                        <div class="detail-info">
                            <div class="detail-item">æœŸå¾…BB: 1/${settingData[setting].bb}</div>
                            <div class="detail-item">æœŸå¾…RB: 1/${settingData[setting].rb}</div>
                            <div class="detail-item">æœŸå¾…åˆç®—: 1/${settingData[setting].bonus}</div>
                            <div class="detail-item">æœŸå¾…é¢¨éˆ´åˆç®—: 1/${settingData[setting].furinTotal}</div>
                        </div>
                    </div>
                `;
            });

            // åˆè¨ˆè¡¨ç¤ºã®è¿½åŠ 
            const totalPct = Object.values(percentages).reduce((a, b) => a + b, 0).toFixed(1);
            resultsHTML += `<div style="text-align:right; color:#aaa; font-size:13px; margin-top:5px;">åˆè¨ˆ: ${totalPct}%</div>`;

            document.getElementById('settingResults').innerHTML = resultsHTML;

            // åˆ¤å®šçµæœè¡¨ç¤º
            let judgeHTML = '<div class="judge-title">å„è¦ç´ ã®åˆ¤å®š</div>';
            judgements.forEach(j => {
                judgeHTML += `
                    <div class="judge-item judge-${j.judge}">
                        <div>
                            <strong>${j.label}</strong>: ${j.value}
                        </div>
                        <div>${j.text}</div>
                    </div>
                `;
            });

            document.getElementById('judgeBox').innerHTML = judgeHTML;
            document.getElementById('results').style.display = 'block';
            
            // ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã ã‘ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            setTimeout(() => {
                document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        function resetAll() {
            if (confirm('å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
                document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
                document.querySelectorAll('input[type="checkbox"]').forEach(input => input.checked = false);
                document.querySelectorAll('.result-display').forEach(display => display.textContent = '-');
                document.getElementById('results').style.display = 'none';
            }
        }
    </script>
</body>
</html>
